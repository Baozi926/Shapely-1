// ┌────────────────────────────────────────────────────────────────────┐ \\
// │ Shapely 0.3 - JavaScript Canvas Library                          	│ \\
// ├────────────────────────────────────────────────────────────────────┤ \\
// │ Copyright © 2013 Luke Haas (http://lukehaas.me)    				│ \\
// ├────────────────────────────────────────────────────────────────────┤ \\
// │ Licensed under the MIT license.									| \\
// └────────────────────────────────────────────────────────────────────┘ \\


(function(e,t){"use strict";function f(e,t){var n=r.exec(e),i,s,o=0,u;i=s=[];if(n[3]&&t.getElementsByClassName){i=[].slice.call(t.getElementsByClassName(n[3]),0)}else if(n[2]){i=[].slice.call(t.getElementsByTagName(e),0)}o=i.length;while(o--){try{u=i[o].getContext("2d");s.push(u)}catch(a){}}return s}function l(e,n){var r=n.length,i=e.length,s=0;if(typeof r==="number"){for(;s<r;s++){e[i++]=n[s]}}else{while(n[s]!==t){e[i++]=n[s++]}}e.length=i;return e}function h(e,t){var n;for(n in t){if(t.hasOwnProperty(n)){e[n]=t[n]}}return e}function p(e,t){var n,r={},i;for(n in t){if(e.hasOwnProperty(n)){if(n=="style"){r.style={};for(i in e.style){r.style[i]=e.style[i];if(t.style.hasOwnProperty(i)){r.style[i]=t.style[i]}}}else{r[n]=t[n]}}}return r}function d(e){var t;if(e.substr(0,3)=="rgb"){e=e.match(/[0-9]+/g);t={r:e[0],g:e[1],b:e[2]}}else{e=e.replace(/#/,"");var n=parseInt(e,16);t={r:n>>16&255,g:n>>8&255,b:n&255}}return t}function v(){this.x=0;this.y=0;this.kappa=.5522847498;this.radian=.01745329251;this.alpha=.6283185307179586;this.width=1;this.height=1;this.sides=1;this.dashWidth=10;this.dashGap=5;this.radius=0;this.style={strokeStyle:"solid",strokeWidth:1}}function m(e,t,n){if(t.shadow){e.shadowOffsetX=t.shadow.offsetX;e.shadowOffsetY=t.shadow.offsetY;e.shadowBlur=t.shadow.blur;e.shadowColor=t.shadow.color}if(t.fillGradient){t.fill=g(e,t.fillGradient)}if(t.strokeGradient){t.strokeColor=g(e,t.strokeGradient)}if(t.pattern){var r=e.createPattern(n.img,"repeat");t.fill=r}if(t.fill){e.fillStyle=t.fill;if(!n.text)e.fill()}if(t.strokeColor){e.strokeStyle=t.strokeColor;e.lineWidth=t.strokeWidth;if(!n.text)e.stroke()}}function g(e,t){var n,r,i;r=i=0;if(t.type=="linear"){n=e.createLinearGradient(t.positions.x1,t.positions.y1,t.positions.x2,t.positions.y2)}else if(t.type=="radial"){n=e.createRadialGradient(t.positions.x1,t.positions.y1,t.positions.r1,t.positions.x2,t.positions.y2,t.positions.r2)}i=t.colors.length;for(;r<i;r++){n.addColorStop(t.colors[r][0],t.colors[r][1])}return n}function y(e,t){var n=0,r=360/e.sides;t.moveTo(e.x,e.y);for(;n<e.sides;n++){t.lineTo(e.x+=Math.cos(r*n*e.radian)*e.radius,e.y+=Math.sin(r*n*e.radian)*e.radius)}}function b(e,t,n){var r,i,s;e.save();if(n.rotation){e.translate(t.tranx,t.trany);e.rotate(n.rotation*t.radian)}e.beginPath();e.moveTo(t.x,t.y);if(n.style.strokeStyle=="dashed"){r=false;if(vertical){s=t.y;i=t.length+t.y;while(s<i){if(r){e.moveTo(t.x,s+=t.dashGap)}else{if((s+=t.dashWidth)>i){e.lineTo(t.x,i)}else{e.lineTo(t.x,s)}}r=!r}}else{s=t.x;i=t.length+t.x;while(s<i){if(r){e.moveTo(s+=t.dashGap,t.y)}else{if((s+=t.dashWidth)>i){e.lineTo(i,t.y)}else{e.lineTo(s,t.y)}}r=!r}}}else{if(vertical){e.lineTo(t.x,t.y+t.length)}else{e.lineTo(t.x+t.length,t.y)}}e.closePath();if(n.style){m(e,n.style,t)}e.restore()}function w(e,t,n){e.save();if(n.rotation){e.translate(t.tranx,t.trany);e.rotate(n.rotation*t.radian)}if(n.src){u.src=n.src}if(n.sx&&n.sy&&n.swidth&&n.sheight){e.drawImage(u,n.sx,n.sy,n.swidth,n.sheight,t.x,t.y,t.width,t.height)}else{e.drawImage(u,t.x,t.y,t.width,t.height)}if(n.style){m(e,n.style,t)}e.restore()}function E(e,t,n){e.save();if(n.rotation){e.translate(t.tranx,t.trany);e.rotate(n.rotation*t.radian)}if(n.align){e.textAlign=n.align}if(n.baseline){e.textBaseline=n.baseline}if(n.style){m(e,n.style,t);if(n.style.font){e.font=n.style.font}if(n.style.fill){e.fillText(n.value,t.x,t.y)}if(n.style.strokeColor){e.strokeText(n.value,t.x,t.y)}}e.restore()}function S(e,t,n){e.save();if(n.rotation){e.translate(t.tranx,t.trany);e.rotate(n.rotation*t.radian)}e.beginPath();y(t,e);e.closePath();if(n.style){m(e,n.style,t)}e.restore()}function x(e,t,n){e.save();if(n.rotation){e.translate(t.tranx,t.trany);e.rotate(n.rotation*t.radian)}e.beginPath();y(t,e);e.closePath();if(n.style){m(e,n.style,t)}e.restore()}function T(e,t,n){var r=11,i,s=t.radius*2,o;e.save();if(n.rotation){e.translate(t.tranx,t.trany);e.rotate(n.rotation*t.radian)}e.beginPath();e.moveTo(t.x+s*Math.sin(t.alpha*r),t.y+s*Math.cos(t.alpha*r));for(;r!=0;r--){i=r%2==1?s:t.radius;o=t.alpha*r;e.lineTo(t.x+i*Math.sin(o),t.y+i*Math.cos(o))}e.closePath();if(n.style){m(e,n.style,t)}e.restore()}function N(e,t,n){e.save();if(n.rotation){e.translate(t.tranx,t.trany);e.rotate(n.rotation*t.radian)}e.beginPath();e.moveTo(t.width+t.x,t.yrad+t.y);e.bezierCurveTo(t.width+t.x,t.yrad+t.ydis+t.y,t.xrad+t.xdis+t.x,t.height+t.y,t.xrad+t.x,t.height+t.y);e.bezierCurveTo(t.xrad-t.xdis+t.x,t.height+t.y,t.x,t.yrad+t.ydis+t.y,t.x,t.yrad+t.y);e.bezierCurveTo(t.x,t.yrad-t.ydis+t.y,t.xrad-t.xdis+t.x,t.y,t.xrad+t.x,t.y);e.bezierCurveTo(t.xrad+t.xdis+t.x,t.y,t.width+t.x,t.yrad-t.ydis+t.y,t.width+t.x,t.yrad+t.y);e.closePath();if(n.style){m(e,n.style,t)}e.restore()}function C(e,t,n){e.save();if(n.rotation){e.translate(t.tranx,t.trany);e.rotate(n.rotation*t.radian)}e.beginPath();if(n.cornerRadius){e.moveTo(t.width+t.x,t.height+t.y-n.cornerRadius);e.bezierCurveTo(t.width+t.x,t.height+t.y-t.radFactor,t.width+t.x-t.radFactor,t.height+t.y,t.width+t.x-n.cornerRadius,t.height+t.y);e.lineTo(t.x+n.cornerRadius,t.height+t.y);e.bezierCurveTo(t.x+t.radFactor,t.height+t.y,t.x,t.height+t.y-t.radFactor,t.x,t.height+t.y-n.cornerRadius);e.lineTo(t.x,t.y+n.cornerRadius);e.bezierCurveTo(t.x,t.y+t.radFactor,t.x+t.radFactor,t.y,t.x+n.cornerRadius,t.y);e.lineTo(t.width+t.x-n.cornerRadius,t.y);e.bezierCurveTo(t.width+t.x-t.radFactor,t.y,t.width+t.x,t.y+t.radFactor,t.width+t.x,t.y+n.cornerRadius);e.lineTo(t.width+t.x,t.height+t.y-n.cornerRadius)}else{e.rect(t.x,t.y,t.width,t.height)}e.closePath();if(n.style){m(e,n.style,t)}e.restore()}var n=e.document,r=/^(?:#([\w-]+)|(\w+)|\.([\w-]+))$/,i="0.3",s,o,u,a=function(e,t){return new a.fun.init(e,t)};a.fun=a.prototype={shapely_version:i,constructor:a,init:function(e,t){s=0;o=[];u=new Image;k.init();var i,a,c,h;if(!e){return this}if(typeof e==="string"){i=r.exec(e);if(i&&i[1]){a=n.getElementById(i[1]);try{c=a.getContext("2d");this.length=1;this[0]=c}catch(p){}return this}else{h=f(e,n);return l(this.constructor(),h)}}return this},length:0,splice:[].slice};a.fun.init.prototype=a.fun;var c={gen:function(){return"shapely"+(shapely_version+Math.random()).replace(/\D/g,"")}};v.prototype.extend=function(e){var t;for(t in e){if(e.hasOwnProperty(t)){if(t=="style"||!isNaN(e[t])){this[t]=e[t]}}}if(this.radius==0){this.yrad=this.height/2;this.xrad=this.width/2}else if(e.polygon){this.yrad=this.xrad=this.radius/2}else{this.yrad=this.xrad=this.radius}if(e.circle){this.ydis=this.yrad*this.kappa;this.xdis=this.xrad*this.kappa;if(this.radius>0){this.width=this.height=this.radius*2}}if(e.style){if(e.style.fill){if(e.style.opacity){this.rgb=d(e.style.fill);e.style.fill="rgba("+this.rgb.r+","+this.rgb.g+","+this.rgb.b+","+e.style.opacity+")"}}if(e.style.strokeColor){if(e.style.opacity){this.rgb=d(e.style.strokeColor);e.style.strokeColor="rgba("+this.rgb.r+","+this.rgb.g+","+this.rgb.b+","+e.style.opacity+")"}}if(e.style.pattern){this.img=new Image;this.img.src=e.style.pattern}}if(e.rotation){this.x-=this.tranx=this.x+this.xrad;this.y-=this.trany=this.y+this.yrad}if(e.cornerRadius){this.radFactor=e.cornerRadius*.449}};a.fun.star=function(){var e=0,t=this.length,n,r,i=arguments[0]||{};n=new v;n.extend(i);o[s++]={shape:n,method:T,options:i,animation:false};for(;e<t;e++){r=this[e]||{};T(r,n,i)}return this};a.fun.triangle=function(){var e=0,t=this.length,n,r,i=arguments[0]||{};i.sides=3;i.polygon=1;n=new v;n.extend(i);o[s++]={shape:n,method:S,options:i,animation:false};for(;e<t;e++){r=this[e]||{};S(r,n,i)}return this};a.fun.line=function(){var e=0,t=this.length,n,r,i=true;options=arguments[0]||{};n=new v;n.extend(options);n.length=Math.max(n.width,n.height);if(n.width>n.height){i=false}o[s++]={shape:n,method:b,options:options,animation:false};for(;e<t;e++){r=this[e]||{};b(r,n,options)}return this};a.fun.polygon=function(){var e=0,t=this.length,n,r,i=arguments[0]||{};i.polygon=1;n=new v;n.extend(i);o[s++]={shape:n,method:x,options:i,animation:false};for(;e<t;e++){r=this[e]||{};x(r,n,i)}return this};a.fun.image=function(){var e=0,t=this.length,n,r=arguments[0]||{},i=new v;i.extend(r);o[s++]={shape:i,method:w,options:r,animation:false};for(;e<t;e++){n=this[e]||{};w(n,i,r)}return this};a.fun.circle=function(){var e=0,t=this.length,n,r,i=arguments[0]||{};i.circle=1;n=new v;n.extend(i);o[s++]={shape:n,method:N,options:i,animation:false};for(;e<t;e++){r=this[e]||{};N(r,n,i)}return this};a.fun.text=function(){var e=0,t=this.length,n,r=arguments[0]||{},i=new v;r.text=1;i.extend(r);o[s++]={shape:i,method:E,options:r,animation:false};for(;e<t;e++){n=this[e]||{};E(n,i,r)}return this};a.fun.rect=a.fun.rectangle=function(){var e=0,t=this.length,n,r,i=arguments[0]||{};n=new v;n.extend(i);o[s++]={shape:n,method:C,options:i,animation:false};for(;e<t;e++){r=this[e]||{};C(r,n,i)}return this};a.fun.animate=function(){var e=arguments[0]||{};e.duration=arguments[1]||1e3;e.transition=L[arguments[2]]||L.easeInOutSine;e.onComplete=arguments[3]||function(){};e.elems=this;e.elemsLength=this.length;e.sub=s-1;k.setOptions(e);o[s-1].diff=p(o[s-1].options,e);o[s-1].animation=true;k.custom(o[s-1].options,o[s-1].diff);return this};var k={init:function(){this.i=0;this.options=[];this.timer=[];this.time=[];this.from=[];this.to=[];this.dimension=[];this.now=[];this.cTime=[];this.queue=[]},setOptions:function(e){this.options[this.i++]=h({onStart:function(){},onComplete:function(){},transition:L.easeInOutSine,duration:1e3,wait:true,fps:50,active:true},e||{})},step:function(){var e=(new Date).getTime(),t=0,n=this.options.length;for(;t<n;t++){if(e<this.time[t]+this.options[t].duration){this.cTime[t]=e-this.time[t];this.setNow(false,t)}else if(this.options[t].active){setTimeout(this.options[t].onComplete.bind(this),10);this.clearTimer(t);this.setNow(true,t)}this.increase(t)}},setNow:function(e,t){var n=0;if(e){for(;n<this.to[t].length;n++){this.now[t][this.dimension[t][n]]=this.to[t][n]}}else{for(;n<this.to[t].length;n++){if(this.dimension[t][n]=="style"){this.now[t][this.dimension[t][n]]=this.computeStyle(this.from[t][n],this.to[t][n],t)}else{this.now[t][this.dimension[t][n]]=this.compute(this.from[t][n],this.to[t][n],t)}}}},compute:function(e,t,n){var r=t-e;return this.options[n].transition(this.cTime[n],e,r,this.options[n].duration)},computeStyle:function(e,t,n){var r,i,s=e;for(r in t){if(typeof t[r]=="number"){i=t[r]-e[r];s[r]=L.linear(this.cTime[n],e[r],i,this.options[n].duration)}}return s},clearTimer:function(e){clearInterval(this.timer[e]);this.timer[e]=null;this.options[e].active=false;return this},_start:function(e,t){var n,r=this.i-1;if(!this.options[r].wait)this.clearTimer(r);if(this.timer[r])return;setTimeout(this.options[r].onStart.bind(this),10);this.from[r]=[];this.to[r]=[];this.dimension[r]=[];this.now[r]=e;for(n in t){this.from[r].push(e[n]);this.to[r].push(t[n]);this.dimension[r].push(n)}this.time[r]=(new Date).getTime();this.timer[r]=setInterval(this.step.bind(this),Math.round(1e3/this.options[r].fps));return this},custom:function(e,t){return this._start(e,t)},clearCanvas:function(e){e.clearRect(0,0,e.canvas.width,e.canvas.height)},setStyle:function(e,t){var n,r,i;n=r=0;i=this.options[t].sub;for(;r<this.options[t].elemsLength;r++){this.clearCanvas(this.options[t].elems[r]);n=0;for(;n<s;n++){if(o[n].animation){if(n==i){this.queue[i]={v:e,stack:o[n]};o[n].shape.extend(e);o[n].method(this.options[t].elems[r],o[n].shape,e)}else if(this.queue[n]){this.queue[n].stack.shape.extend(this.queue[n].v);this.queue[n].stack.method(this.options[t].elems[r],this.queue[n].stack.shape,this.queue[n].v)}}else{o[n].method(this.options[t].elems[r],o[n].shape,o[n].options)}}}},increase:function(e){this.setStyle(this.now[e],e)}};var L={linear:function(e,t,n,r){return n*e/r+t},easeInQuad:function(e,t,n,r){return n*(e/=r)*e+t},easeOutQuad:function(e,t,n,r){return-n*(e/=r)*(e-2)+t},easeInOutQuad:function(e,t,n,r){if((e/=r/2)<1)return n/2*e*e+t;return-n/2*(--e*(e-2)-1)+t},easeInCubic:function(e,t,n,r){return n*(e/=r)*e*e+t},easeOutCubic:function(e,t,n,r){return n*((e=e/r-1)*e*e+1)+t},easeInOutCubic:function(e,t,n,r){if((e/=r/2)<1)return n/2*e*e*e+t;return n/2*((e-=2)*e*e+2)+t},easeInQuart:function(e,t,n,r){return n*(e/=r)*e*e*e+t},easeOutQuart:function(e,t,n,r){return-n*((e=e/r-1)*e*e*e-1)+t},easeInOutQuart:function(e,t,n,r){if((e/=r/2)<1)return n/2*e*e*e*e+t;return-n/2*((e-=2)*e*e*e-2)+t},easeInQuint:function(e,t,n,r){return n*(e/=r)*e*e*e*e+t},easeOutQuint:function(e,t,n,r){return n*((e=e/r-1)*e*e*e*e+1)+t},easeInOutQuint:function(e,t,n,r){if((e/=r/2)<1)return n/2*e*e*e*e*e+t;return n/2*((e-=2)*e*e*e*e+2)+t},easeInSine:function(e,t,n,r){return-n*Math.cos(e/r*(Math.PI/2))+n+t},easeOutSine:function(e,t,n,r){return n*Math.sin(e/r*(Math.PI/2))+t},easeInOutSine:function(e,t,n,r){return-n/2*(Math.cos(Math.PI*e/r)-1)+t},easeInExpo:function(e,t,n,r){return e==0?t:n*Math.pow(2,10*(e/r-1))+t},easeOutExpo:function(e,t,n,r){return e==r?t+n:n*(-Math.pow(2,-10*e/r)+1)+t},easeInOutExpo:function(e,t,n,r){if(e==0)return t;if(e==r)return t+n;if((e/=r/2)<1)return n/2*Math.pow(2,10*(e-1))+t;return n/2*(-Math.pow(2,-10*--e)+2)+t},easeInCirc:function(e,t,n,r){return-n*(Math.sqrt(1-(e/=r)*e)-1)+t},easeOutCirc:function(e,t,n,r){return n*Math.sqrt(1-(e=e/r-1)*e)+t},easeInOutCirc:function(e,t,n,r){if((e/=r/2)<1)return-n/2*(Math.sqrt(1-e*e)-1)+t;return n/2*(Math.sqrt(1-(e-=2)*e)+1)+t},easeInElastic:function(e,t,n,r){var i=1.70158;var s=0;var o=n;if(e==0)return t;if((e/=r)==1)return t+n;if(!s)s=r*.3;if(o<Math.abs(n)){o=n;var i=s/4}else var i=s/(2*Math.PI)*Math.asin(n/o);return-(o*Math.pow(2,10*(e-=1))*Math.sin((e*r-i)*2*Math.PI/s))+t},easeOutElastic:function(e,t,n,r){var i=1.70158;var s=0;var o=n;if(e==0)return t;if((e/=r)==1)return t+n;if(!s)s=r*.3;if(o<Math.abs(n)){o=n;var i=s/4}else var i=s/(2*Math.PI)*Math.asin(n/o);return o*Math.pow(2,-10*e)*Math.sin((e*r-i)*2*Math.PI/s)+n+t},easeInOutElastic:function(e,t,n,r){var i=1.70158;var s=0;var o=n;if(e==0)return t;if((e/=r/2)==2)return t+n;if(!s)s=r*.3*1.5;if(o<Math.abs(n)){o=n;var i=s/4}else var i=s/(2*Math.PI)*Math.asin(n/o);if(e<1)return-.5*o*Math.pow(2,10*(e-=1))*Math.sin((e*r-i)*2*Math.PI/s)+t;return o*Math.pow(2,-10*(e-=1))*Math.sin((e*r-i)*2*Math.PI/s)*.5+n+t},easeInBack:function(e,n,r,i){if(s==t)var s=1.70158;return r*(e/=i)*e*((s+1)*e-s)+n},easeOutBack:function(e,n,r,i){if(s==t)var s=1.70158;return r*((e=e/i-1)*e*((s+1)*e+s)+1)+n},easeInOutBack:function(e,n,r,i){if(s==t)var s=1.70158;if((e/=i/2)<1)return r/2*e*e*(((s*=1.525)+1)*e-s)+n;return r/2*((e-=2)*e*(((s*=1.525)+1)*e+s)+2)+n},easeInBounce:function(e,t,n,r){return n-L.easeOutBounce(r-e,0,n,r)+t},easeOutBounce:function(e,t,n,r){if((e/=r)<1/2.75){return n*7.5625*e*e+t}else if(e<2/2.75){return n*(7.5625*(e-=1.5/2.75)*e+.75)+t}else if(e<2.5/2.75){return n*(7.5625*(e-=2.25/2.75)*e+.9375)+t}else{return n*(7.5625*(e-=2.625/2.75)*e+.984375)+t}},easeInOutBounce:function(e,t,n,r){if(e<r/2)return L.easeInBounce(e*2,0,n,r)*.5+t;return L.easeOutBounce(e*2-r,0,n,r)*.5+n*.5+t}};e.shapely=a})(window)